---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

```{r}
rm(list=ls())
library(corrplot)
df <- read.csv(file="./volatility.csv")
head(df)


AAPL.PVol = df$AAPL.PVol
GOOG.PVol = df$GOOG.PVol
AMZN.PVol = df$AMZN.PVol
GSPC.PVol = df$GSPC.PVol
VIX.Close = df$VIX.Close
AAPL.Close = df$AAPL.Close
VXAPLCLS = df$VXAPLCLS
VXAZNCLS = df$VXAZNCLS
VXGOGCLS = df$VXGOGCLS 
GOOG.Close = df$GOOG.Close
AMZN.Close = df$AMZN.Close
GSPC.Close = df$GSPC.Close 
Date = df$Date
AAPL.Ret = df$AAPL.Ret
AMZN.Ret = df$AMZN.Ret
GOOG.Ret = df$GOOG.Ret
GSPC.Ret = df$GSPC.Ret
AAPL.Vol = df$AAPL.Vol
```

```{r}
library(dplyr)
library(ggplot2)
```

```{r}
m = cov(cbind(AAPL.PVol,GOOG.PVol,AMZN.PVol,GSPC.PVol, 
          VIX.Close, AAPL.Close, VXAPLCLS, VXAZNCLS, 
          VXGOGCLS, GOOG.Close, AMZN.Close, GSPC.Close,
          Date, AAPL.Ret, AMZN.Ret, GOOG.Ret, GSPC.Ret, AAPL.Vol))
ans <- data.frame(row=rownames(m)[row(m)], col=colnames(m)[col(m)], corr=c(m)) %>% filter(col == 'AAPL.Vol')
write.csv(ans, "./cov.csv", row.names = FALSE)
ans
```

## **Looking at correlation between variables**

```{r}
corr_matrix = cbind(AAPL.PVol, GOOG.PVol,AMZN.PVol,GSPC.PVol,  AAPL.Close, GOOG.Close, AMZN.Close, GSPC.Close, AAPL.Ret, GOOG.Ret, AMZN.Ret, GSPC.Ret, VXAPLCLS, VXGOGCLS, VXAZNCLS, VIX.Close, AAPL.Vol, Date)
corr_matrix = cor(corr_matrix, method = c("pearson"))
corrplot(corr_matrix, method="color")
```

## **Descriptive Statistics:**

```{r}
# Getting descriptive statistics
summary(AAPL.PVol)
summary(GOOG.PVol)
summary(AMZN.PVol)
summary(GSPC.PVol)
```

```{r}
summary(VXAPLCLS) 
summary(VXAZNCLS)
summary(VXGOGCLS) 
```

```{r}
summary(VIX.Close)
summary(AAPL.Close)
summary(GOOG.Close) 
summary(AMZN.Close)
summary(GSPC.Close)
```

```{r}
summary(AAPL.Ret) 
summary(AMZN.Ret) 
summary(GOOG.Ret) 
summary(GSPC.Ret) 
```

```{r}
summary(AAPL.Vol)
```

## **Looking at Apple.Volatility vs Apple.PVolatility**

```{r}
# Fitting a simple linear regression model for AAPL.Vol and 
# each independent variable, and checking the five key
# assumptions: Linear relationship, Multivariate normality, 
# No multicollinearity, No auto-correlation and Homoscedasticity, 
# the assumptions of the simple linear regression are acceptable.
summary(lm(AAPL.Vol~AAPL.PVol))
```

```{r}
plot(AAPL.PVol,AAPL.Vol)
abline(lm(AAPL.Vol~AAPL.PVol))
```

```{r}
plot(lm(AAPL.Vol ~ AAPL.PVol))
```

```{r}

X = AAPL.PVol
Y = AAPL.Vol^1.3
summary(lm(Y ~ X))
mod = lm(formula = Y ~ X)
plot(X, Y)
abline(mod)
plot(lm(Y~X))

```

## **Looking at Apple.Volatility vs Google.PVolatility**

```{r}
summary(lm(AAPL.Vol~GOOG.PVol))
```

```{r}
plot(GOOG.PVol, AAPL.Vol)
abline(lm(AAPL.Vol~GOOG.PVol))
```

```{r}
plot(lm(AAPL.Vol~GOOG.PVol))
```

WOrking to transform data

```{r}
# plot(AAPL.PVol, resid(lm(AAPL.Vol~exp(AAPL.PVol))))
# plot(lm(AAPL.Vol ~ log(AAPL.PVol)))
X = GOOG.PVol^3
Y = AAPL.Vol
summary(lm(Y ~ X))
mod = lm(formula = Y ~ X)
plot(X, Y)
abline(mod)
plot(lm(Y~X))
# abline(lm(AAPL.Vol~(AAPL.PVol^2)))
```

## **Looking at Apple.Volatility vs Amazon.PVolatility**

```{r}
summary(lm(AAPL.Vol~AMZN.PVol))
```

```{r}
plot(AMZN.PVol,AAPL.Vol)
abline(lm(AAPL.Vol~AMZN.PVol))
```

```{r}
plot(lm(AAPL.Vol~AMZN.PVol))
```

```{r}
X = AMZN.PVol^2
Y = AAPL.Vol^1.3
summary(lm(Y ~ X))
mod = lm(formula = Y ~ X)
plot(X, Y)
abline(mod)
plot(lm(Y~X))
```

## **Looking at Apple.Volatility vs GSPC.PVol**

```{r}
summary(lm(AAPL.Vol~GSPC.PVol))
```

```{r}
plot(GSPC.PVol, AAPL.Vol)
abline(lm(AAPL.Vol~GSPC.PVol))
```

```{r}
plot(lm(AAPL.Vol~GSPC.PVol))
```

```{r}
X = GSPC.PVol^2
Y = AAPL.Vol
summary(lm(Y ~ X))
mod = lm(formula = Y ~ X)
plot(X, Y)
abline(mod)
plot(lm(Y~X))
```

# Closing Prices

#### A. Appl.Vol vs AAPL.Close

```{r}
summary(lm(AAPL.Vol~AAPL.Close))
plot(AAPL.Vol~AAPL.Close)
abline(lm(AAPL.Vol~AAPL.Close))
# plot(AAPL.Close, lm(AAPL.Vol~AAPL.Close)$residuals)
plot(lm(AAPL.Vol~AAPL.Close))
```

#### B. Appl.Vol vs GOOG.Close

```{r}
summary(lm(AAPL.Vol~GOOG.Close))
plot(AAPL.Vol~GOOG.Close)
abline(lm(AAPL.Vol~GOOG.Close))
#plot(GOOG.Close, lm(AAPL.Vol~GOOG.Close)$residuals)
plot(lm(AAPL.Vol~GOOG.Close))
```

#### C. Appl.Vol vs AMZN.Close

```{r}
summary(lm(AAPL.Vol~AMZN.Close))
plot(AAPL.Vol~AMZN.Close)
abline(lm(AAPL.Vol~AMZN.Close))
# plot(AMZN.Close, lm(AAPL.Vol~AMZN.Close)$residuals)
plot(lm(AAPL.Vol~AMZN.Close))
```

#### D. Appl.Vol vs GSPC.Close

```{r}
summary(lm(AAPL.Vol~GSPC.Close))
plot(AAPL.Vol~GSPC.Close)
abline(lm(AAPL.Vol~GSPC.Close))
# plot(GSPC.Close, lm(AAPL.Vol~GSPC.Close)$residuals)
plot(lm(AAPL.Vol~GSPC.Close))
```

# **RETURNS**

#### A. Appl.Vol vs AAPL.Ret

```{r}
##returns
summary(lm(AAPL.Vol~AAPL.Ret))
plot(AAPL.Vol~AAPL.Ret)
abline(lm(AAPL.Vol~AAPL.Ret))
# plot(AAPL.Ret, lm(AAPL.Vol~AAPL.Ret)$residuals)
plot(lm(AAPL.Vol~AAPL.Ret))
```

#### B. Appl.Vol vs GOOG.Ret

```{r}
summary(lm(AAPL.Vol~GOOG.Ret))
plot(AAPL.Vol~GOOG.Ret)
abline(lm(AAPL.Vol~GOOG.Ret))
#plot(AAPL.Ret, lm(AAPL.Vol~GOOG.Ret)$residuals)
plot(lm(AAPL.Vol~GOOG.Ret))
```

#### C. Appl.Vol vs. AMZN.Ret

```{r}
summary(lm(AAPL.Vol~AMZN.Ret))
plot(AAPL.Vol~AMZN.Ret)
abline(lm(AAPL.Vol~AMZN.Ret))
# plot(AMZN.Ret, lm(AAPL.Vol~AMZN.Ret)$residuals)
plot(lm(AAPL.Vol~AMZN.Ret))
```

#### D. Appl.Vol vs GSPC.Ret

```{r}
summary(lm(AAPL.Vol~GSPC.Ret))
plot(AAPL.Vol~GSPC.Ret)
abline(lm(AAPL.Vol~GSPC.Ret))
# plot(GSPC.Ret, lm(AAPL.Vol~GSPC.Ret)$residuals)
plot(lm(AAPL.Vol~GSPC.Ret))
```

# **VIX**

#### A. Appl.Vol vs. VXAPLCLS

```{r}
summary(lm(AAPL.Vol~VXAPLCLS))
plot(AAPL.Vol~VXAPLCLS)
abline(lm(AAPL.Vol~VXAPLCLS))
# plot(VXAPLCLS, lm(AAPL.Vol~VXAPLCLS)$residuals)
plot(lm(AAPL.Vol~VXAPLCLS))
```

#### B. Appl.Vol vs. VXGOGCLS

```{r}
summary(lm(AAPL.Vol~VXGOGCLS))
plot(AAPL.Vol~VXGOGCLS)
abline(lm(AAPL.Vol~VXGOGCLS))
# plot(VXGOGCLS, lm(AAPL.Vol~VXGOGCLS)$residuals)
plot(lm(AAPL.Vol~VXGOGCLS))
```

#### C. Appl.Vol vs. VXAZNCLS

```{r}
summary(lm(AAPL.Vol~VXAZNCLS))
plot(AAPL.Vol~VXAZNCLS)
abline(lm(AAPL.Vol~VXAZNCLS))
# plot(VXAZNCLS, lm(AAPL.Vol~VXAZNCLS)$residuals)
plot(lm(AAPL.Vol~VXAZNCLS))
```

#### D. Appl.Vol vs. VIX.Close

```{r}
summary(lm(AAPL.Vol~VIX.Close))
plot(AAPL.Vol~VIX.Close)
abline(lm(AAPL.Vol~VIX.Close))
# plot(VIX.Close, lm(AAPL.Vol~VIX.Close)$residuals)
plot(lm(AAPL.Vol~VIX.Close))
```

```{r}
'
##predicted volatilities
plot(AAPL.Vol~AAPL.PVol)
abline(lm(AAPL.Vol~AAPL.PVol))

plot(AAPL.PVol, resid(lm(AAPL.Vol~AAPL.PVol)))

plot(AAPL.Vol~GOOG.PVol)
abline(lm(AAPL.Vol~GOOG.PVol))

plot(GOOG.PVol, lm(AAPL.Vol~GOOG.PVol)$residuals)


plot(AAPL.Vol~AMZN.PVol)
abline(lm(AAPL.Vol~AMZN.PVol))

plot(AMZN.PVol, lm(AAPL.Vol~AMZN.PVol)$residuals)

plot(AAPL.Vol~GSPC.PVol)
abline(lm(AAPL.Vol~GSPC.PVol))

plot(GSPC.PVol, lm(AAPL.Vol~GSPC.PVol)$residuals)
'
```
